<app-spinner-component></app-spinner-component>

<div style="text-align: center;"> 
  <img src="assets/images/Header.png" alt="Download image" style="width:350px; height:auto; padding-top: 20px;"> 
</div>

<div class="container">  
  
  <div class="form-section">
    <label class="label">PDB File:</label>
    <div class="file has-name is-primary">
      <label class="file-label">
        <input
          class="file-input"
          type="file"
          accept=".pdb"
          (change)="onFileChange($event)"
        />
        <span class="file-cta">
          <span class="file-icon has-text-white">
            <i class="fas fa-upload"></i>
          </span>
          <span class="file-label has-text-white">Choose a PDB File...</span>
        </span>
        <span class="file-name" *ngIf="pdbFile">
          {{ pdbFile.name }}
        </span>
      </label>
    </div>
  </div>
  
    <div class="form-section" >
      <label>Protein Chains:</label>
      <input type="text" [(ngModel)]="form.protein_chains" placeholder="e.g. A,B"/>
    </div>
  
    <div class="form-section">
      <label>Partner Chains:</label>
      <input type="text" [(ngModel)]="form.partner_chains" placeholder="e.g. C,D"/>
    </div>
  
    <div class="form-section">
      <label>Mutations:</label>
      <input type="text" placeholder="e.g. ARGC59 GLUC60"
      [(ngModel)]="form.mutations" 
      [disabled]="form.detect_interface"/>
    </div>
  
    <div class="form-section">
      <label class="checkbox">
        <input type="checkbox" [(ngModel)]="form.detect_interface" (click)="onCheckBox()"/>
        Detect Interface
      </label>
    </div>
  
    <button class="button is-primary" (click)="onGoClick()"  [disabled]="!isGoEnabled()"
    style="margin-bottom: 30px;">Go</button>

    <div *ngIf="showViewer" class="box mb-4" style="background-color: lightgray;">
      <div class="columns is-vcentered is-multiline">
        <!-- Representation Dropdown -->
        <div class="column is-one-quarter">
          <label class="label">Representation</label>
          <div class="control has-icons-left">
            <div class="select is-fullwidth">
              <select [(ngModel)]="viewerSettings.representation" (change)="updateRepresentation()">
                <option value="cartoon">Cartoon</option>
                <option value="surface">Surface</option>
                <option value="ball+stick">Ball + Stick</option>
                <option value="licorice">Licorice</option>
                <option value="ribbon">Ribbon</option>
                <option value="spacefill">Spacefill</option>
                <option value="backbone">Backbone</option>
                <option value="axes">Axes</option>
                <option value="hyperball">Hyperball</option>
                <option value="distance">Distance</option>
                <option value="contact">Contact</option>
                <option value="label">Label</option>
              </select>
            </div>
            <span class="icon is-left">
              <i class="fas fa-shapes"></i>
            </span>
          </div>
        </div>
  
        <!-- Color Scheme Dropdown -->
        <div class="column is-one-quarter">
          <label class="label">Color Scheme</label>
          <div class="control has-icons-left">
            <div class="select is-fullwidth">
              <select [(ngModel)]="viewerSettings.color" (change)="updateRepresentation()">
                <option value="chainname">Chain</option>
                <option value="element">Element</option>
                <option value="hydrophobicity">Hydrophobicity</option>
                <option value="resname">Residue Name</option>
                <option value="bfactor">B-Factor</option>
                <option value="uniform">Uniform</option>
                <option value="hydrophobicity">Hydrophobicity</option>
                <option value="chainid">Chainid</option>
              </select>
            </div>
            <span class="icon is-left">
              <i class="fas fa-palette"></i>
            </span>
          </div>
        </div>
  
        <!-- Focus Chain Input -->
        <div class="column is-one-quarter">
          <label class="label">Focus Chain</label>
          <div class="control has-icons-left">
            <input 
              class="input" 
              type="text" 
              [(ngModel)]="viewerSettings.focusChain" 
              placeholder="e.g. A" 
              (keyup.enter)="focusChain()"
            />
            <span class="icon is-left">
              <i class="fas fa-crosshairs"></i>
            </span>
          </div>
        </div>
  
        <!-- Download Image Button -->
        <div class="column is-one-quarter has-text-centered">
          <label class="label is-invisible">Download</label>
          <button class="button is-primary is-fullwidth" (click)="takeScreenshot()">
            <span class="icon">
              <i class="fas fa-download"></i>
            </span>
            <span>Download Image</span>
          </button>
        </div>
      </div>
    </div>
  
    <!-- Viewer Container -->
    <div *ngIf="showViewer" #viewerSection class="viewer-container">
      <div id="viewport" style="width:100%; height:600px; border:1px solid #ccc; border-radius:8px;"></div>
    </div>
    
    <!-- Heatmap wit the results -->
    <div *ngIf="resultFiles.length && showViewer" class="box" style="margin-top: 30px; text-align: center;">
      <h3 class="title is-5">Energy Heatmap</h3>
      <div id="heatmapDiv"
          style="display: inline-block; margin: auto; width: 90%; max-width: 850px; height: 450px; border: 1px solid #333; border-radius: 8px; padding: 8px; background: #fafafa;">
      </div>
    </div>

  </div>